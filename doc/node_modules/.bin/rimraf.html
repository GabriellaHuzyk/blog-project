<!DOCTYPE html>
<html>
<head>
  <title>rimraf</title>
  <meta http-equiv="content-type" content="text/html; charset=UTF-8">
  <link rel="stylesheet" media="all" href="../../doc-style.css" />
  <script src="../../doc-filelist.js"></script>
  <script>
    var relativeDir = "../../";
    var thisFile = "node_modules/.bin/rimraf";
    var defaultSidebar = true;
  </script>
  <script src="../../doc-script.js"></script>

</head>
<body>
  <div id="sidebar_wrapper">
    <div id="sidebar_switch">
      <span class="tree">Files</span>
      <span class="headings">Headings</span>
    </div>
    <div id="tree"></div>
    <div id="headings">

      <div class="heading h1">
        <a href="#sourcemappingurlbin.js.map">sourceMappingURL=bin.js.map</a>
      </div>

    </div>
  </div>
  <div id="sidebar-toggle"></div>
  <div id="container">
    <div class="background highlight"></div>
<table cellpadding="0" cellspacing="0">
  <tbody>
    
      <tr>
        <td class="docs">
          <h1>rimraf</h1>
        </td>
        <td class="code highlight"></td>
      </tr>
    
    
      <tr>
        <td class="docs">
          <div class="pilwrap">
  <a class="pilcrow" href="#section-1" id="section-1"></a>
</div>

        </td>
        <td class="code highlight">
          <pre class="javascript"><span class="hljs-meta">#!/usr/bin/env node</span>
<span class="hljs-meta">"use strict"</span>;
<span class="hljs-keyword">var</span> __importDefault = (<span class="hljs-keyword">this</span> &amp;&amp; <span class="hljs-keyword">this</span>.__importDefault) || <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">mod</span>) </span>{
    <span class="hljs-keyword">return</span> (mod &amp;&amp; mod.__esModule) ? mod : { <span class="hljs-string">"default"</span>: mod };
};
<span class="hljs-built_in">Object</span>.defineProperty(exports, <span class="hljs-string">"__esModule"</span>, { <span class="hljs-attr">value</span>: <span class="hljs-literal">true</span> });
exports.help = <span class="hljs-keyword">void</span> <span class="hljs-number">0</span>;
<span class="hljs-keyword">const</span> package_json_1 = <span class="hljs-built_in">require</span>(<span class="hljs-string">"../package.json"</span>);
<span class="hljs-keyword">const</span> index_cjs_js_1 = __importDefault(<span class="hljs-built_in">require</span>(<span class="hljs-string">"./index-cjs.js"</span>));
<span class="hljs-keyword">const</span> runHelpForUsage = <span class="hljs-function"><span class="hljs-params">()</span> =&gt;</span> <span class="hljs-built_in">console</span>.error(<span class="hljs-string">'run `rimraf --help` for usage information'</span>);
exports.help = <span class="hljs-string">`rimraf version <span class="hljs-subst">${package_json_1.version}</span>

Usage: rimraf &lt;path&gt; [&lt;path&gt; ...]
Deletes all files and folders at "path", recursively.

Options:
  --                   Treat all subsequent arguments as paths
  -h --help            Display this usage info
  --preserve-root      Do not remove '/' recursively (default)
  --no-preserve-root   Do not treat '/' specially
  -G --no-glob         Treat arguments as literal paths, not globs (default)
  -g --glob            Treat arguments as glob patterns
  -v --verbose         Be verbose when deleting files, showing them as
                       they are removed. Not compatible with --impl=native
  -V --no-verbose      Be silent when deleting files, showing nothing as
                       they are removed (default)
  -i --interactive     Ask for confirmation before deleting anything
                       Not compatible with --impl=native
  -I --no-interactive  Do not ask for confirmation before deleting

  --impl=&lt;type&gt;        Specify the implementation to use:
                       rimraf: choose the best option (default)
                       native: the built-in implementation in Node.js
                       manual: the platform-specific JS implementation
                       posix: the Posix JS implementation
                       windows: the Windows JS implementation (falls back to
                                move-remove on ENOTEMPTY)
                       move-remove: a slow reliable Windows fallback

Implementation-specific options:
  --tmp=&lt;path&gt;        Temp file folder for 'move-remove' implementation
  --max-retries=&lt;n&gt;   maxRetries for 'native' and 'windows' implementations
  --retry-delay=&lt;n&gt;   retryDelay for 'native' implementation, default 100
  --backoff=&lt;n&gt;       Exponential backoff factor for retries (default: 1.2)
`</span>;
<span class="hljs-keyword">const</span> path_1 = <span class="hljs-built_in">require</span>(<span class="hljs-string">"path"</span>);
<span class="hljs-keyword">const</span> cwd = process.cwd();
<span class="hljs-keyword">const</span> readline_1 = <span class="hljs-built_in">require</span>(<span class="hljs-string">"readline"</span>);
<span class="hljs-keyword">const</span> prompt = <span class="hljs-keyword">async</span> (rl, q) =&gt; <span class="hljs-keyword">new</span> <span class="hljs-built_in">Promise</span>(<span class="hljs-function"><span class="hljs-params">res</span> =&gt;</span> rl.question(q, res));
<span class="hljs-keyword">const</span> interactiveRimraf = <span class="hljs-keyword">async</span> (impl, paths, opt) =&gt; {
    <span class="hljs-keyword">const</span> existingFilter = opt.filter || <span class="hljs-function">(<span class="hljs-params">(</span>) =&gt;</span> <span class="hljs-literal">true</span>);
    <span class="hljs-keyword">let</span> allRemaining = <span class="hljs-literal">false</span>;
    <span class="hljs-keyword">let</span> noneRemaining = <span class="hljs-literal">false</span>;
    <span class="hljs-keyword">const</span> queue = [];
    <span class="hljs-keyword">let</span> processing = <span class="hljs-literal">false</span>;
    <span class="hljs-keyword">const</span> processQueue = <span class="hljs-keyword">async</span> () =&gt; {
        <span class="hljs-keyword">if</span> (processing)
            <span class="hljs-keyword">return</span>;
        processing = <span class="hljs-literal">true</span>;
        <span class="hljs-keyword">let</span> next;
        <span class="hljs-keyword">while</span> ((next = queue.shift())) {
            <span class="hljs-keyword">await</span> next();
        }
        processing = <span class="hljs-literal">false</span>;
    };
    <span class="hljs-keyword">const</span> oneAtATime = <span class="hljs-function">(<span class="hljs-params">fn</span>) =&gt;</span> <span class="hljs-keyword">async</span> (s, e) =&gt; {
        <span class="hljs-keyword">const</span> p = <span class="hljs-keyword">new</span> <span class="hljs-built_in">Promise</span>(<span class="hljs-function"><span class="hljs-params">res</span> =&gt;</span> {
            queue.push(<span class="hljs-keyword">async</span> () =&gt; {
                <span class="hljs-keyword">const</span> result = <span class="hljs-keyword">await</span> fn(s, e);
                res(result);
                <span class="hljs-keyword">return</span> result;
            });
        });
        processQueue();
        <span class="hljs-keyword">return</span> p;
    };
    <span class="hljs-keyword">const</span> rl = (<span class="hljs-number">0</span>, readline_1.createInterface)({
        <span class="hljs-attr">input</span>: process.stdin,
        <span class="hljs-attr">output</span>: process.stdout,
    });
    opt.filter = oneAtATime(<span class="hljs-keyword">async</span> (path, ent) =&gt; {
        <span class="hljs-keyword">if</span> (noneRemaining) {
            <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>;
        }
        <span class="hljs-keyword">while</span> (!allRemaining) {
            <span class="hljs-keyword">const</span> a = (<span class="hljs-keyword">await</span> prompt(rl, <span class="hljs-string">`rm? <span class="hljs-subst">${(<span class="hljs-number">0</span>, path_1.relative)(cwd, path)}</span>\n[(Yes)/No/All/Quit] &gt; `</span>)).trim();
            <span class="hljs-keyword">if</span> (<span class="hljs-regexp">/^n/i</span>.test(a)) {
                <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>;
            }
            <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (<span class="hljs-regexp">/^a/i</span>.test(a)) {
                allRemaining = <span class="hljs-literal">true</span>;
                <span class="hljs-keyword">break</span>;
            }
            <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (<span class="hljs-regexp">/^q/i</span>.test(a)) {
                noneRemaining = <span class="hljs-literal">true</span>;
                <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>;
            }
            <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (a === <span class="hljs-string">''</span> || <span class="hljs-regexp">/^y/i</span>.test(a)) {
                <span class="hljs-keyword">break</span>;
            }
            <span class="hljs-keyword">else</span> {
                <span class="hljs-keyword">continue</span>;
            }
        }
        <span class="hljs-keyword">return</span> existingFilter(path, ent);
    });
    <span class="hljs-keyword">await</span> impl(paths, opt);
    rl.close();
};
<span class="hljs-keyword">const</span> main = <span class="hljs-keyword">async</span> (...args) =&gt; {
    <span class="hljs-keyword">const</span> verboseFilter = <span class="hljs-function">(<span class="hljs-params">s</span>) =&gt;</span> {
        <span class="hljs-built_in">console</span>.log((<span class="hljs-number">0</span>, path_1.relative)(cwd, s));
        <span class="hljs-keyword">return</span> <span class="hljs-literal">true</span>;
    };
    <span class="hljs-keyword">if</span> (process.env.__RIMRAF_TESTING_BIN_FAIL__ === <span class="hljs-string">'1'</span>) {
        <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-built_in">Error</span>(<span class="hljs-string">'simulated rimraf failure'</span>);
    }
    <span class="hljs-keyword">const</span> opt = {};
    <span class="hljs-keyword">const</span> paths = [];
    <span class="hljs-keyword">let</span> dashdash = <span class="hljs-literal">false</span>;
    <span class="hljs-keyword">let</span> impl = index_cjs_js_1.default;
    <span class="hljs-keyword">let</span> interactive = <span class="hljs-literal">false</span>;
    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">const</span> arg <span class="hljs-keyword">of</span> args) {
        <span class="hljs-keyword">if</span> (dashdash) {
            paths.push(arg);
            <span class="hljs-keyword">continue</span>;
        }
        <span class="hljs-keyword">if</span> (arg === <span class="hljs-string">'--'</span>) {
            dashdash = <span class="hljs-literal">true</span>;
            <span class="hljs-keyword">continue</span>;
        }
        <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (arg === <span class="hljs-string">'-rf'</span> || arg === <span class="hljs-string">'-fr'</span>) {
</pre>
        </td>
      </tr>
    
      <tr>
        <td class="docs">
          <div class="pilwrap">
  <a class="pilcrow" href="#section-2" id="section-2"></a>
</div>
<p>this never did anything, but people put it there I guess</p>

        </td>
        <td class="code highlight">
          <pre class="javascript">            <span class="hljs-keyword">continue</span>;
        }
        <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (arg === <span class="hljs-string">'-h'</span> || arg === <span class="hljs-string">'--help'</span>) {
            <span class="hljs-built_in">console</span>.log(exports.help);
            <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;
        }
        <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (arg === <span class="hljs-string">'--interactive'</span> || arg === <span class="hljs-string">'-i'</span>) {
            interactive = <span class="hljs-literal">true</span>;
            <span class="hljs-keyword">continue</span>;
        }
        <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (arg === <span class="hljs-string">'--no-interactive'</span> || arg === <span class="hljs-string">'-I'</span>) {
            interactive = <span class="hljs-literal">false</span>;
            <span class="hljs-keyword">continue</span>;
        }
        <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (arg === <span class="hljs-string">'--verbose'</span> || arg === <span class="hljs-string">'-v'</span>) {
            opt.filter = verboseFilter;
            <span class="hljs-keyword">continue</span>;
        }
        <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (arg === <span class="hljs-string">'--no-verbose'</span> || arg === <span class="hljs-string">'-V'</span>) {
            opt.filter = <span class="hljs-literal">undefined</span>;
            <span class="hljs-keyword">continue</span>;
        }
        <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (arg === <span class="hljs-string">'-g'</span> || arg === <span class="hljs-string">'--glob'</span>) {
            opt.glob = <span class="hljs-literal">true</span>;
            <span class="hljs-keyword">continue</span>;
        }
        <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (arg === <span class="hljs-string">'-G'</span> || arg === <span class="hljs-string">'--no-glob'</span>) {
            opt.glob = <span class="hljs-literal">false</span>;
            <span class="hljs-keyword">continue</span>;
        }
        <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (arg === <span class="hljs-string">'--preserve-root'</span>) {
            opt.preserveRoot = <span class="hljs-literal">true</span>;
            <span class="hljs-keyword">continue</span>;
        }
        <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (arg === <span class="hljs-string">'--no-preserve-root'</span>) {
            opt.preserveRoot = <span class="hljs-literal">false</span>;
            <span class="hljs-keyword">continue</span>;
        }
        <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (<span class="hljs-regexp">/^--tmp=/</span>.test(arg)) {
            <span class="hljs-keyword">const</span> val = arg.substring(<span class="hljs-string">'--tmp='</span>.length);
            opt.tmp = val;
            <span class="hljs-keyword">continue</span>;
        }
        <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (<span class="hljs-regexp">/^--max-retries=/</span>.test(arg)) {
            <span class="hljs-keyword">const</span> val = +arg.substring(<span class="hljs-string">'--max-retries='</span>.length);
            opt.maxRetries = val;
            <span class="hljs-keyword">continue</span>;
        }
        <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (<span class="hljs-regexp">/^--retry-delay=/</span>.test(arg)) {
            <span class="hljs-keyword">const</span> val = +arg.substring(<span class="hljs-string">'--retry-delay='</span>.length);
            opt.retryDelay = val;
            <span class="hljs-keyword">continue</span>;
        }
        <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (<span class="hljs-regexp">/^--backoff=/</span>.test(arg)) {
            <span class="hljs-keyword">const</span> val = +arg.substring(<span class="hljs-string">'--backoff='</span>.length);
            opt.backoff = val;
            <span class="hljs-keyword">continue</span>;
        }
        <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (<span class="hljs-regexp">/^--impl=/</span>.test(arg)) {
            <span class="hljs-keyword">const</span> val = arg.substring(<span class="hljs-string">'--impl='</span>.length);
            <span class="hljs-keyword">switch</span> (val) {
                <span class="hljs-keyword">case</span> <span class="hljs-string">'rimraf'</span>:
                    impl = index_cjs_js_1.default;
                    <span class="hljs-keyword">continue</span>;
                <span class="hljs-keyword">case</span> <span class="hljs-string">'native'</span>:
                <span class="hljs-keyword">case</span> <span class="hljs-string">'manual'</span>:
                <span class="hljs-keyword">case</span> <span class="hljs-string">'posix'</span>:
                <span class="hljs-keyword">case</span> <span class="hljs-string">'windows'</span>:
                    impl = index_cjs_js_1.default[val];
                    <span class="hljs-keyword">continue</span>;
                <span class="hljs-keyword">case</span> <span class="hljs-string">'move-remove'</span>:
                    impl = index_cjs_js_1.default.moveRemove;
                    <span class="hljs-keyword">continue</span>;
                <span class="hljs-keyword">default</span>:
                    <span class="hljs-built_in">console</span>.error(<span class="hljs-string">`unknown implementation: <span class="hljs-subst">${val}</span>`</span>);
                    runHelpForUsage();
                    <span class="hljs-keyword">return</span> <span class="hljs-number">1</span>;
            }
        }
        <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (<span class="hljs-regexp">/^-/</span>.test(arg)) {
            <span class="hljs-built_in">console</span>.error(<span class="hljs-string">`unknown option: <span class="hljs-subst">${arg}</span>`</span>);
            runHelpForUsage();
            <span class="hljs-keyword">return</span> <span class="hljs-number">1</span>;
        }
        <span class="hljs-keyword">else</span> {
            paths.push(arg);
        }
    }
    <span class="hljs-keyword">if</span> (opt.preserveRoot !== <span class="hljs-literal">false</span>) {
        <span class="hljs-keyword">for</span> (<span class="hljs-keyword">const</span> path <span class="hljs-keyword">of</span> paths.map(<span class="hljs-function"><span class="hljs-params">p</span> =&gt;</span> (<span class="hljs-number">0</span>, path_1.resolve)(p))) {
            <span class="hljs-keyword">if</span> (path === (<span class="hljs-number">0</span>, path_1.parse)(path).root) {
                <span class="hljs-built_in">console</span>.error(<span class="hljs-string">`rimraf: it is dangerous to operate recursively on '/'`</span>);
                <span class="hljs-built_in">console</span>.error(<span class="hljs-string">'use --no-preserve-root to override this failsafe'</span>);
                <span class="hljs-keyword">return</span> <span class="hljs-number">1</span>;
            }
        }
    }
    <span class="hljs-keyword">if</span> (!paths.length) {
        <span class="hljs-built_in">console</span>.error(<span class="hljs-string">'rimraf: must provide a path to remove'</span>);
        runHelpForUsage();
        <span class="hljs-keyword">return</span> <span class="hljs-number">1</span>;
    }
    <span class="hljs-keyword">if</span> (impl === index_cjs_js_1.default.native &amp;&amp; (interactive || opt.filter)) {
        <span class="hljs-built_in">console</span>.error(<span class="hljs-string">'native implementation does not support -v or -i'</span>);
        runHelpForUsage();
        <span class="hljs-keyword">return</span> <span class="hljs-number">1</span>;
    }
    <span class="hljs-keyword">if</span> (interactive) {
        <span class="hljs-keyword">await</span> interactiveRimraf(impl, paths, opt);
    }
    <span class="hljs-keyword">else</span> {
        <span class="hljs-keyword">await</span> impl(paths, opt);
    }
    <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;
};
main.help = exports.help;
exports.default = main;
<span class="hljs-keyword">if</span> (<span class="hljs-keyword">typeof</span> <span class="hljs-built_in">require</span> === <span class="hljs-string">'function'</span> &amp;&amp;
    <span class="hljs-keyword">typeof</span> <span class="hljs-built_in">module</span> === <span class="hljs-string">'object'</span> &amp;&amp;
    <span class="hljs-built_in">require</span>.main === <span class="hljs-built_in">module</span>) {
    <span class="hljs-keyword">const</span> args = process.argv.slice(<span class="hljs-number">2</span>);
    main(...args).then(<span class="hljs-function"><span class="hljs-params">code</span> =&gt;</span> process.exit(code), er =&gt; {
        <span class="hljs-built_in">console</span>.error(er);
        process.exit(<span class="hljs-number">1</span>);
    });
}
</pre>
        </td>
      </tr>
    
      <tr>
        <td class="docs">
          <div class="pilwrap" id="sourcemappingurlbin.js.map">
  <h1>
    <a href="#sourcemappingurlbin.js.map" name="sourcemappingurlbin.js.map" class="pilcrow"></a>
sourceMappingURL=bin.js.map
  </h1>
</div>

        </td>
        <td class="code highlight">
          <pre class="javascript"></pre>
        </td>
      </tr>
    
  </tbody>
</table>

  </div>
</body>
</html>
